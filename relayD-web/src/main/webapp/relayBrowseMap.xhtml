<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions">

<h:head>
	<script type="text/javascript">
    	function handleDrop(event, ui) {
        	var droppedPerson = ui.draggable;
	        droppedPerson.fadeOut('fast');
    	}
	</script>
	
	<link
		rel="stylesheet"
		href="./styles/relayd.css"></link>
	<link
		rel="icon"
		href="http://relayd.de:8080/relayD-web/favicon.ico" />
</h:head>
<h:body>
	<h:form id="form">

		<p:growl
			id="growl"
			showDetail="true" />

		<div class="divStartHeader"></div>

		<p:layout>

			<p:layoutUnit
				position="west"
				resizable="true"
				size="45%">
					<p:treeTable
						id="relayTable"
						selection="#{relayBrowseMapPageBean.selectedNode}"
						selectionMode="single"
						value="#{relayBrowseMapPageBean.root}"
						var="relayRow">
						<f:facet name="header">
			            Relays
			        	</f:facet>
						<p:column headerText="Name">
							<h:outputText value="#{relayRow.relayname}" />
						</p:column>
						<p:column headerText="Participant">
							<h:outputText value="#{relayRow.participant}" />
						</p:column>
					</p:treeTable>
			</p:layoutUnit>

			<p:layoutUnit
				position="center"
				size="10%" />

			<p:layoutUnit
				position="east"
				size="45%">
					<p:dataTable
						var="person"
						widgetVar="personTable"
						filteredValue="#{relayBrowseMapPageBean.filteredPersons}"
						id="personTable"
						selectionMode="multiple"
						value="#{relayBrowseMapPageBean.persons}"
						selection="#{relayBrowseMapPageBean.selectedPersons}"
						scrollable="true"
						sortBy="#{person.surename.toString()}"
						rowKey="#{person.uuid}"
						resizableColumns="true">
						<f:facet name="header">
				     		List of Persons
						</f:facet>
	
						<p:column
							headerText="Forename"
							sortBy="#{person.forename}"
							width="45%">
							<h:outputText
								id="forenameId"
								value="#{person.forename}" />
							<p:draggable
								for="forenameId"
								revert="true"
								helper="clone" />
						</p:column>
	
						<p:column
							headerText="Surename"
							filterMatchMode="contains"
							sortBy="#{person.surename}"
							width="45%">
							<h:outputText value="#{person.surename}" />
						</p:column>
					</p:dataTable>
			</p:layoutUnit>
		</p:layout>

		<p:droppable for="relayTable" tolerance="touch" activeStyleClass="ui-state-highlight" datasource="personTable" onDrop="handleDrop">
        	<p:ajax listener="#{relayBrowseMapPageBean.onPersonDrop}" update="form" />
    	</p:droppable>

		<ui:include src="/dock.xhtml" />

	</h:form>
</h:body>
</html>