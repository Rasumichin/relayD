<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions">

<h:head>
	<link
		rel="stylesheet"
		href="./styles/relayd.css"></link>
	<link
		rel="icon"
		href="http://relayd.de:8080/relayD-web/favicon.ico" />
</h:head>

<h:body>
	<h:form id="form">

		<p:growl
			id="growl"
			showDetail="true" />

		<div class="divStartHeader"></div>

		<p:layout>
			<p:layoutUnit
				position="west"
				resizable="true"
				size="45%">
				<p:toolbar>
					<f:facet name="left">
						<p:commandButton
							actionListener="#{relayBrowsePageBean.addRelay}"
							update="form"
							icon="ui-icon-plus">
							<p:ajax
								event="dialogReturn"
								listener="#{relayBrowsePageBean.onRelayEditClosed}"
								update="form" />
						</p:commandButton>
						<p:commandButton
							actionListener="#{relayBrowsePageBean.removeRelay}"
							update="form"
							icon="ui-icon-trash">
						</p:commandButton>
						<p:commandButton
							actionListener="#{relayBrowsePageBean.editRelay}"
							icon="ui-icon-pencil"
							update="form">
							<p:ajax
								event="dialogReturn"
								listener="#{relayBrowsePageBean.onRelayEditClosed}"
								update="form" />
						</p:commandButton>
					</f:facet>
				</p:toolbar>
				<p:treeTable
					id="relayTable"
					selection="#{relayBrowsePageBean.selectedNode}"
					selectionMode="single"
					value="#{relayBrowsePageBean.root}"
					var="relayRow">
					<f:facet name="header">
		            Relays
		        	</f:facet>
					<p:column headerText="Name">
						<h:outputText value="#{relayRow.relayname}" />
					</p:column>
					<p:column headerText="Participant">
						<h:outputText value="#{relayRow.participant}" />
					</p:column>
				</p:treeTable>

			</p:layoutUnit>

			<p:layoutUnit
				position="center"
				size="5%">
				<p:commandButton
					value="add"
					style="width:95%"
					update="form"
					icon="ui-icon-circle-triangle-w"
					actionListener="#{relayBrowsePageBean.addPersonToRelay}">

				</p:commandButton>

				<p:commandButton
					value="remove"
					style="width:95%"
					update="form"
					icon="ui-icon-circle-triangle-e"
					actionListener="#{relayBrowsePageBean.removePersonFromRelay}">

				</p:commandButton>

			</p:layoutUnit>

			<p:layoutUnit
				position="east"
				size="45%">
				<p:toolbar>
					<f:facet name="right">
						<p:commandButton
							update="personTable"
							icon="ui-icon-plus"
							actionListener="#{relayBrowsePageBean.addPerson}">
							<p:ajax
								event="dialogReturn"
								listener="#{relayBrowsePageBean.onPersonEditClosed}"
								update="form" />
						</p:commandButton>
						<p:commandButton
							update="form"
							icon="ui-icon-trash"
							actionListener="#{relayBrowsePageBean.removePerson}" />
						<p:commandButton
							update="form"
							actionListener="#{relayBrowsePageBean.editPerson}"
							icon="ui-icon-pencil">
							<p:ajax
								event="dialogReturn"
								listener="#{relayBrowsePageBean.onPersonEditClosed}"
								update="form" />
						</p:commandButton>
						<p:commandButton
							value="export"
							icon="ui-icon-mail-closed"
							update="form"
							actionListener="#{relayBrowsePageBean.emailExport}" />
						<p:menuButton value="Filter">
							<p:menuitem
								value="All"
								actionListener="#{relayBrowsePageBean.showAll}"
								update="form"
								icon="ui-icon-disk" />
							<p:separator />
							<p:menuitem
								value="Relays with space"
								actionListener="#{relayBrowsePageBean.showRelaysWithSpace}"
								update="form"
								icon="ui-icon-arrow-4-diag" />
							<p:separator />
							<p:menuitem
								value="All without relay"
								actionListener="#{relayBrowsePageBean.showAllWithoutRelay}"
								update="form"
								icon="ui-icon-person" />
						</p:menuButton>
					</f:facet>
				</p:toolbar>
				<p:dataTable
					var="person"
					widgetVar="personTable"
					filteredValue="#{relayBrowsePageBean.filteredPersons}"
					id="personTable"
					selectionMode="multiple"
					value="#{relayBrowsePageBean.persons}"
					selection="#{relayBrowsePageBean.selectedPersons}"
					scrollable="true"
					sortBy="#{person.surename.toString()}"
					rowKey="#{person.uuid}"
					resizableColumns="true">
					<f:facet name="header">
			     		List of Persons
					</f:facet>

					<p:column
						visible="true"
						toggleable="false"
						width="2%">
						<p:rowToggler />
					</p:column>

					<p:column
						headerText="Forename"
						sortBy="#{person.forename}"
						sortFunction="#{relayBrowsePageBean.sortByForename}"
						width="20%">
						<h:outputText value="#{person.forename}" />
					</p:column>

					<p:column
						headerText="Surename"
						filterMatchMode="contains"
						sortBy="#{person.surename}"
						sortFunction="#{relayBrowsePageBean.sortBySurename}"
						width="25%">
						<h:outputText value="#{person.surename}" />
					</p:column>

					<p:column
						headerText="Comment"
						width="53%">
						<h:outputText value="#{person.comment}" />
					</p:column>

					<p:rowExpansion>
						<p:panelGrid
							columns="2"
							columnClasses="label,value">

							<h:outputText value="Year of Birth" />
							<h:outputText value="#{person.yearOfBirth}" />

							<h:outputText value="Shirtsize" />
							<h:outputText value="#{person.shirtsize.toString()}" />

							<h:outputText value="Email" />
							<h:outputText value="#{person.email}" />

						</p:panelGrid>

					</p:rowExpansion>

				</p:dataTable>
			</p:layoutUnit>
		</p:layout>


		<ui:include src="/dock.xhtml" />

	</h:form>
</h:body>
</html>